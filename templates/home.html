{% extends "base.html" %}

{% block home%}

  {% load profiles_extra %}
  {% load static %}
  {% load thumbnail %}


	<div class="row" id="Logincont">
		<div class="col-sm-2 " id="userpanel" >
			<div class="profile-sidebar">
				<!-- SIDEBAR USERPIC -->
					<div class="home_userpic ">
					{% if request.user.profile.image %}
					  {% thumbnail  request.user.profile.image "462x462" crop="center" as im %}
            	<img src="{{ im.url }}"  class="img-responsive imagefix" id="imgprofil" >
						{% endthumbnail %}
					{% else %}
						{% with path=MEDIA_URL|add:"user/default_user_image.png" %}
						  {% thumbnail path "462x462" crop="center" as im %}
				  			<img src="{{ im.url }}"  class="img-responsive img-rounded center-block" id="imgprofil">
						  {% endthumbnail %}
						{% endwith %}
					{% endif %}
					</div>

				<div class="profile-usertitle">
					<div class="profile-usertitle-name">
						{{ request.user.get_full_name }}
					</div>
					<div class="col-"></div>
					 <a href="/home/addmeal/" class="btn btn-primary btn-sm buttonmin">Add Meal</a> 
					 <a href="/home/myfavourites/" class="btn btn-primary btn-sm buttonmin">My Favorites</a> 
					 <a href="/home/mymeals/" class="btn btn-primary btn-sm buttonmin">My Meals</a>
					 <a href="/home/mostfavourites/" class="btn btn-primary btn-sm buttonmin">Most Favorites</a> 
				</div>
				<!--           -->

				<!-- Sliderbar -->
				<div class="alert alert-success" role="alert" style=" margin-top: 35px; ">
				<center><h3><u>Meal Filter<u></h3></center>

				<form method="POST" action="/home/filter/" accept-charset="UTF-8">
				{% csrf_token %}
					 <div style="  margin-top: 35px;"> 
						
						<div class="col-xs-10 col-xs-offset-1" id="slider-range"></div>
						<div class="col-sm-11 col-md-9 col-xs-8 col-sm-offset-1 col-md-offset-3 col-xs-offset-4" id="range_calori"> 
							<p>
							<label for="amount" style="margin-top:10px; margin-left:-6px;">Calories </label>
							<input type="text" id="amount" name="amount" readonly style="border:0; font-weight:bold; background: none;  margin-left:-5px;">
						</p>
						</div>
						<div class="width_btn">
								<select class="selectpicker dish" name="kind_select" multiple>
									<option class="optionsID">Ana Yemek</option>
									<option class="optionsID" >Başlangıç</option>
									<option class="optionsID">Ara Sıcak</option>
								</select>
								<br><br>
						<div class="col-sm-11 col-md-9 col-xs-8 col-sm-offset-1 col-md-offset-3 col-xs-offset-4" id="range_calori"> 		
							<button type="submit" id="filter_button" name="filter_button" class="btn btn-primary">Filter</button>
						</div>
						</div>
					
				</div>
				</form>
				</div>
				<!-- Sliderbar -->

	    </div>
	   </div>

		<div class="col-sm-10 col-sm-offset-2 " id="content" >

			<div class="page-header">
      	{% if homePage %}
				  <h2 class="degis" > Home Page </h2>
				{% elif myFavouritesPage %}
				  <h2 class="degis"> Your Favourite Meals </h2>
				{% elif searchPage %}
				  <h2 class="degis"> Your Search </h2>
				{% elif filterPage %}
				  <h2 class="degis"> Your Filter Search</h2>
				{% elif mostFavouritesPage %}
				  <h2 class="degis"> Most Favourite Meals </h2>
				{% else %}
				  <h2 class="degis"> Your Meals </h2>
				{% endif %}	
			</div>

      <div class="timeline">
      
			{% if myFavouritesPage or myMealsPage %}
			  {% if meals_available %}
					<div class="checkbox pull-right">
					<label><input  type="checkbox" id="selectall" name="selectall"> Select All</label>
					</div>
				{% endif %}
			{% endif %}

      {% if myFavouritesPage or myMealsPage %}
        {% if meals_available %}
      	  <form accept-charset="UTF-8" method="GET">
        {% endif %}
      {% endif %}
			
			{% for meal in AllMeal %}
					
					<div class="line text-muted" id="transp"></div>
					<article class="panel panel-primary">
				
						<div class="panel-heading icon">
							<i class="fa fa-plus"></i>
						</div>
				 
						<div class="panel-heading">
							<h2 class="panel-title">
							  {% if homePage %}

							    {% if meal.user.profile.secret_profile and meal.user != request.user %}
							  		<a href="{% url 'user_profile' meal.user.username %}" id="{{ meal.user.username }}" class="btn disabled" style="padding:0;"> <u>{{ meal.user.get_full_name }}</u> </a>  bir   {{ meal.meal_kind }}   ekledi. ( {{ meal.name }})
							    {% else %}
							      <a href="{% url 'user_profile' meal.user.username %}" id="{{ meal.user.username }}"> <u>{{ meal.user.get_full_name }}</u> </a>  bir   {{ meal.meal_kind }}   ekledi. ( {{ meal.name }})
							    {% endif %}

							  {% elif myMealsPage %}
                  {{ meal.name }} ( {{ meal.meal_kind }} )
							  {% else %}

							    {% if meal.user.profile.secret_profile and meal.user != request.user %}
							  		 {{ meal.name }} ( <a href="{% url 'user_profile' meal.user.username %}" id="{{ meal.user.username }}" class="btn disabled" style="padding:0;"> <u>{{ meal.user.get_full_name }}</u></a> )
							    {% else %}
							       {{ meal.name }} ( <a href="{% url 'user_profile' meal.user.username %}" id="{{ meal.user.username }}" > <u>{{ meal.user.get_full_name }}</u></a> )
							    {% endif %}
							    
							  {% endif %} 
						     	
						  
						  <!-- favori butonu-->
						  {% if homePage or mostFavouritesPage %}
						    {% if request.user != meal.user %}
							    <div class="pull-right stars active" style="background: transparent;border: transparent;">

								  	{% if allFavouriteMeals|hasMeal:meal %}
									  
									  	<button id="{{meal.id}}" class="fa fa-star star" style="background: transparent;
									  	 border: transparent;"><span class="icon_fav" id="{{ meal.id }}"> {{ meal.favourite }} </span></button>	
										{% else %}
								  		
								  		<button id="{{meal.id}}" class="fa fa-star-o star" style="background: transparent;
								  		border: transparent;"><span class="icon_fav" id="{{ meal.id }}"> {{ meal.favourite }} </span></button> 	
										{% endif %}
										
									</div>
								{% else %}
								 	<div class="pull-right" style="background: transparent;border: transparent;">
										<span class="icon_fav"> {{ meal.favourite }} favourite{{ meal.favourite|pluralize }} </span>
									</div>
								{% endif %}
							{% endif %}

							{% if myFavouritesPage or myMealsPage %}
								{% if meals_available %}
							  	<div class="pull-right stars active" style="background: transparent;border: transparent;">
							  		<input type="checkbox" id="{{ meal.id }}" name="meal" value="{{ meal.id }}" class="checkbox_container">
							  	</div>
							  {% endif %}
							{% endif %}
							
							</h2> 
						</div>
						
						<div class="panel-body" id="contenttext">
							{{ meal.description }}
						</div>
						
						<div class="panel-footer">
						 <button type="button" id="{{ meal.id }}" class="pull-right btn btn-primary btn-sm meal" style="margin-top: -5px;">Show Meal</button>
							<small>
					
								<!--{{ meal.addingDate|timesince:currentTime }}-->
								{{ meal.addingDate|timeDifference:currentTime}}

							</small>

						</div>
						
					</article>

			{% endfor %}
    
      {% if myFavouritesPage or myMealsPage %}
        {% if meals_available %}
        		<button type="Submit" class="pull-right btn btn-primary btn-sm meal" value="Delete"> Seçili Öğeleri Kaldır </button>
      		<form>
      	{% endif %}
      {% endif %}

			<article class="panel panel-info panel-outline">
					
				<div class="panel-heading icon">
					<i class="glyphicon glyphicon-info-sign"></i>
				</div>
				
				
				<div class="panel-body degis4" >
				  {% if meals_available %}
						That is all.
					{% else %}
					  Meal not available
					{% endif %}
				</div>

			</article>
		
		</div>
	       
	</div>
    {% if myFavouritesPage or mostFavouritesPage or myMealsPage %}
      <a id="backhomepage" href="/home/" class="fa fa-home"></a>
    {% endif %}
</div>

{% endblock %}